#!/bin/bash
#MISE description="Add an existing GitHub repo as a remote and push main"

set -euo pipefail
export GIT_DIR=.bare

REPO="${1:?Usage: mise run remote-add <owner/repo>}"
NAME="${2:-origin}"
URL="git@github.com:${REPO}.git"

git remote add "$NAME" "$URL"
git config "remote.$NAME.fetch" "+refs/heads/*:refs/remotes/$NAME/*"
git fetch "$NAME"
git push -u "$NAME" main

echo ""
echo "Remote '$NAME' added and main branch pushed."
echo "  $URL"
